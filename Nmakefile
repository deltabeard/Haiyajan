# Simple makefile for Microsoft NMAKE only
# Example usage:
#   nmake /NOLOGO /B /f .\Nmakefile SDL_LIB=C:\Users\foo\Downloads\SDL2-devel-2.0.12-VC\SDL2\lib\x64 SDL_INC=C:\Users\foo\Downloads\SDL2-devel-2.0.12-VC\SDL2
# Where SDL_LIB is the location of SDL2.lib, and SDL_INC is a folder containing
# a subfolder also named "SDL2" which contains header files such as "SDL.h".

#SDL_INC	=
#SDL_LIB	=

!IFNDEF SDL_INC
!ERROR "SDL2 include folder must be set in SDL_INC"
!ENDIF

VERSION_MAJOR = 0
VERSION_MINOR = 1

DEBUG		= 0

!IF "$(DEBUG)" != "0"
WARN	= 3
OPT		= /Zi /Od /GS /analyze
!ELSE
WARN	= 2
OPT		= /Gw /GL /O2 /GA /Zo- /GS-
!ENDIF

CC	= cl /nologo
CFLAGS	= /EHsc /W$(WARN) $(OPT) /utf-8 /fp:fast /I inc /I $(SDL_INC) /Drestrict=""
LDLIBS	= /link SDL2.lib SDL2main.lib shell32.lib \
	/VERSION:$(VERSION_MAJOR).$(VERSION_MINOR) /SUBSYSTEM:CONSOLE

all: haiyajan.exe

haiyajan.exe: src/haiyajan.obj src/load.obj src/play.obj src/timer.obj \
		src/font.obj src/input.obj src/gl.obj src/rec.obj src/util.obj \
		src/tinflate.obj src/sig.obj
	$(CC) $(CFLAGS) $(**F) $(LDLIBS)

clean:
	del *.obj haiyajan.exe
